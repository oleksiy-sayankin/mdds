/*
 * Copyright (c) 2025 Oleksiy Oleksandrovych Sayankin. All Rights Reserved.
 * Refer to the LICENSE file in the root directory for full license details.
 */
syntax = "proto3";

package solver;

option java_package = "com.mdds.grpc.solver";
option java_multiple_files = true;

// gRPC service for solving system of linear equations.
service SolverService {
  rpc SubmitTask(SubmitTaskRequest) returns (SubmitTaskResponse);
  rpc GetTaskStatus(GetTaskStatusRequest) returns (GetTaskStatusResponse);
  rpc CancelTask(CancelTaskRequest) returns (CancelTaskResponse);
}

// Request for solving SLAE
message SubmitTaskRequest {
  string taskId = 1;            // unique task id
  string method = 2;            // method name (e.g: "numpy_exact_solver")
  repeated Row matrix = 3;      // matrix A
  repeated double rhs = 4;      // right hand side b

}

// Request for getting task status
message GetTaskStatusRequest {
  string taskId = 1;
}

// Request for cancelling of running solving process for SLAE
message CancelTaskRequest {
  string taskId = 1;
}

enum GrpcTaskStatus {
  UNKNOWN = 0;
  DONE = 1;
  ERROR = 2;
  CANCELLED = 3;
  IN_PROGRESS = 4;
}

enum RequestStatus {
  UNSPECIFIED = 0;
  COMPLETED = 1;
  DECLINED = 2;
}

message CancelTaskResponse {
  RequestStatus requestStatus = 1;
  string requestStatusDetails = 2;
}

message GetTaskStatusResponse {
  RequestStatus requestStatus = 1;
  string requestStatusDetails = 2;
  GrpcTaskStatus grpcTaskStatus = 3;
  string taskMessage = 4;
  repeated double solution = 5; // solution of SLAE
}

// Matrix for SLAE as repeated row
message Row {
  repeated double values = 1;
}

// Solution
message SubmitTaskResponse {
  RequestStatus requestStatus = 1;
  string requestStatusDetails = 2;
}
